<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.winter.app.board.notice.NoticeDAO">
	<sql id="search">
		<if test="kind == 'k1'">
			WHERE board_title LIKE concat('%', #{search}, '%')
		</if>
		<if test="kind == 'k2'">
			WHERE board_contents LIKE concat('%', #{search}, '%')
		</if>
		<if test="kind == 'k3'">
			WHERE board_writer LIKE concat('%', #{search}, '%')
		</if>
	</sql>
	
	<select id="list" resultType="NoticeDTO" parameterType="Pager">
		SELECT * 
		FROM notice 
		<include refid="search"/>
		ORDER BY board_num DESC
		LIMIT #{startNum}, #{perPage}
	</select>
	
	<select id="count" resultType="Long" parameterType="pager">
   		 SELECT COUNT(*) FROM notice
		<include refid="search"/>   		 
	</select>

	
	<select id="detail" resultType="NoticeDTO" parameterType="NoticeDTO">
		SELECT * FROM notice WHERE board_num=#{boardNum}
	</select>
	
	<insert id="add" parameterType="NoticeDTO">
		INSERT INTO notice (board_writer, board_title, board_contents, board_date, board_hit) 
		VALUES (#{boardWriter}, #{boardTitle}, #{boardContents}, now(), 0) 
	</insert>
	
	<update id="update" parameterType="NoticeDTO">
		UPDATE notice set
			board_title = #{boardTitle}, board_contents = #{boardContents}
   			where board_num = #{boardNum}
	</update>
	
	<delete id="delete" parameterType="NoticeDTO">
		DELETE FROM notice where board_num=#{boardNum}
	</delete>
	
</mapper>